/* =============================================================
 * jQuery colonizr V0.9.1 - Molokoloco 2013 - Copyleft
 * "In-between titles Multicols paragraphes" (Bootstrap-like plugin)
 * Live fiddle : http://jsfiddle.net/molokoloco/Ra288/
 * Github : https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.js
            https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.min.js
 *          https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonizr.css
 *  Infos : http://www.b2bweb.fr/molokoloco/jquery-colonize-plugin-in-between-titles-multicols-paragraphes-with-css3/
 * ============================================================== */

!function(b){function g(a,h){this.options=b.extend(!0,{},b.fn.colonizr.defaults,"object"==typeof h&&h||{});this.$container=b(a);this.wrapper='<div class="'+this.options.css+'"/>';this.cWidth;this.colHeightRatio;this.intentNextP;this.lineHeight;this.maxHeight;this.refresh()}g.prototype={constructor:g,colsExtractor:function(a,h){for(var d=b(h),c=d.next(),e=[],g=!1,j=0;c;)c.is(this.options.take)?(e.push(c),c=c.next()):(c.is(this.options.chapters)||(g=!0),c=null);var f=0;if(e.length){a=0;for(c=e.length;a<
c;a++)f+=e[a].outerHeight()}if(e.length&&f>this.lineHeight){f=b(this.wrapper);a=0;for(c=e.length;a<c;a++)j+=e[a].outerHeight()*this.colHeightRatio,f.append(e[a].detach()),e[a+1]&&this.maxHeight<=j+e[a+1].outerHeight()&&(f.insertAfter(d),d=f,j=0,f=b(this.wrapper));f.insertAfter(d);g&&this.colsExtractor(0,f.next())}else g&&(this.intentNextP++,3>this.intentNextP&&d.next()&&this.colsExtractor(0,d.next()))},refresh:function(){this.cWidth=this.$container.width();this.colHeightRatio=1;this.lineHeight=this.intentNextP=
0;this.maxHeight=this.options.maxHeight;var a=this.cWidth;1>this.options.maxHeight&&(this.maxHeight=Math.max(80,b(window).height()-60));a=this.$container.find("."+this.options.css);a.length&&a.each(function(){var a=b(this);b(a.html()).insertBefore(a);a.remove()});a=b("<p>A</p>").appendTo(this.$container);this.lineHeight=a.outerHeight();this.lineHeight*=this.options.minLine;a.remove();this.options.colWidth&&(this.options.colCount=Math.max(1,Math.floor(this.cWidth/this.options.colWidth)));a=(this.cWidth-
2*this.options.marge*this.options.colCount)/this.options.colCount;this.colHeightRatio=this.cWidth/a;this.$container.find(this.options.chapters).each(b.proxy(this.colsExtractor,this))}};var k=b.fn.colonizr;b.fn.colonizr=function(a){return this.each(function(){var h=b(this),d=h.data("colonizr");d||h.data("colonizr",d=new g(this,a));if("string"==typeof a)d[a]()})};b.fn.colonizr.Constructor=g;b.fn.colonizr.defaults={marge:10,colWidth:null,colCount:2,chapters:"h1,h2,h3,h4,h5,h6",take:"p",css:"multiplecolumns",
minLine:2,maxHeight:null};b.fn.colonizr.noConflict=function(){b.fn.colonizr=k;return this};b(window).on("load",function(){b('[data-colonizr="true"]').each(function(){var a=b(this);a.colonizr(a.data())})})}(window.jQuery);
