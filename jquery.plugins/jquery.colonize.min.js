// jQuery colonize V0.8.2 : In-between titles Multicols paragraphes
// Molokoloco 2013 - Copyleft
// Live fiddle : http://jsfiddle.net/molokoloco/Ra288/
// Github : https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonize.js
//          https://github.com/molokoloco/FRAMEWORK/blob/master/jquery.plugins/jquery.colonize.css
// Infos :  http://b2bweb.fr/molokoloco/jquery-colonize-plugin-in-between-titles-multicols-paragraphes-with-css3/

(function(c){c.fn.colonize=function(b){b=c.extend(!0,{},c.fn.colonize.defaults,"object"==typeof b&&b);var e=null,p='<div class="'+b.css+'"/>',f=0,h=0,k=0,l=0,m=0,n=function(){for(var d=c(this),a=d.next(),g=[],e=!1,f=0;a;)a.is(b.take)?(g.push(a),a=a.next()):(a.is(b.chapters)||(e=!0),a=null);if(1<g.length||g.length&&g[0].outerHeight()>m){for(var a=c(p),j=0,h=g.length;j<h;j++)f+=g[j].height()*k,a.append(g[j].detach()),f>=b.maxHeight&&g[j+1]&&(a.insertAfter(d),d=a,f=0,a=c(p));a.insertAfter(d);e&&c.proxy(n,
a.next())()}else e&&(l++,3>l&&d.next()&&c.proxy(n,d.next())())};return this.each(function(){e=c(this);h=f=e.width();k=1;m=l=0;1>b.maxHeight&&(b.maxHeight=Math.max(80,c(window).height()-60));var d=e.find("."+b.css);d.length&&d.each(function(){var a=c(this);c(a.html()).insertBefore(a);a.remove()});d=c("<p>A</p>").appendTo(e);m=d.outerHeight();d.remove();b.colWidth&&(b.colCount=Math.max(1,Math.floor(f/b.colWidth)));h=(f-2*b.marge*b.colCount)/b.colCount;k=f/h;e.find(b.chapters).each(n)})};c.fn.colonize.defaults=
{marge:10,colWidth:null,colCount:null,chapters:"h1,h2,h3,h4,h5,h6",take:"p",css:"multiplecolumns",maxHeight:null}})(window.jQuery);
